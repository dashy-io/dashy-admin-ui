"use strict";$(".list-group-item").on("click",function(e){var t=$(this).closest(".list-group").children(".active");t.removeClass("active"),$(e.target).addClass("active")});var dashyAdmin=angular.module("dashyAdmin",["ngRoute"]);dashyAdmin.config(["$routeProvider","$locationProvider",function(e){e.when("/",{templateUrl:"main.html",controller:"MainCtrl",controllerAs:"main"}).when("/dashboards/:dashboardId",{templateUrl:"dashboard.html",controller:"DashboardCtrl",controllerAs:"dashboard"}).when("/settings",{template:""}).otherwise({redirectTo:"/"})}]),dashyAdmin.factory("api",["$http",function(e){return{getServerStatus:function(){return e.get("http://api.dashy.io/status")},getUserDashboards:function(t){return e.get("http://api.dashy.io/users/"+t)},newDevice:function(t,r){return e({method:"POST",headers:{"Content-Type":"application/json"},data:{shortCode:r},url:"http://api.dashy.io//users/"+t+"/claims/"})},getDashboard:function(t){return e.get("http://api.dashy.io/dashboards/"+t)},deleteDashboard:function(t){return e.delete("http://api.dashy.io/dashboards/"+t)},setDashboard:function(t){return e({method:"PUT",headers:{"Content-Type":"application/json"},data:{interval:t.interval,name:t.name,urls:t.urls},url:"http://api.dashy.io/dashboards/"+t.id})}}}]),dashyAdmin.value("serverConnected",!1),dashyAdmin.value("currentUser","cc1f2ba3-1a19-44f2-ae78-dc9784a2a60f"),dashyAdmin.controller("ServerStatusCtrl",["$scope","api","serverConnected",function(e,t,r){var o=t.getServerStatus();o.success(function(t,o){e.serverStatus=o,r=!0,$(".btn-newDevice").prop("disabled",!1)}).error(function(){e.serverStatus=0})}]),dashyAdmin.controller("NewDeviceCtrl",["$scope","api","currentUser","$timeout",function(e,t,r,o){e.shortCode=null,e.validateShortCode=null,e.newDevice=function(){null===e.shortCode||6!==e.shortCode.length?e.validateShortCode=!1:(e.validateShortCode=!0,$(".btn-connectDevice").button("loading"),o(function(){$(".btn-connectDevice").button("reset"),$("#connectDevice").modal("hide"),e.shortCode="",e.validateShortCode=null},1500))}}]),dashyAdmin.controller("MainCtrl",["$scope","api","currentUser",function(e,t,r){var o=t.getUserDashboards(r);o.success(function(r){r.dashboards.forEach(function(r){t.getDashboard(r).success(function(t){e.dashboards=[],e.dashboards.push(t)})})}).error(function(){e.dashboards=[],e.dashboardsError="Couldn't load your dashboards"}),e.deleteDashboard=function(e){window.confirm("Are you sure you want to delete your dashboard "+e.name)&&console.log("deleting "+e.id)}}]),dashyAdmin.controller("DashboardCtrl",["$scope","api","$routeParams","$timeout",function(e,t,r,o){t.getDashboard(r.dashboardId).success(function(t){e.dashboard=t}),e.addUrl=function(){e.dashboard.urls.push("insert url")},e.removeUrl=function(t){e.dashboard.urls.splice(t,1)},e.saveDashboard=function(e){$(".btn-save").button("loading"),$(".btn-save").prop("disabled",!0),t.setDashboard(e).success(function(){$(".btn-save").button("complete"),o(function(){$(".btn-save").button("reset")},1500)}).error(function(e){window.alert("error updating: "+e)})}}]);